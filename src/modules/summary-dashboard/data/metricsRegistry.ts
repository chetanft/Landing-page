import type { MetricDefinition, TabId } from '../types/metrics'

export const metricsRegistry: MetricDefinition[] = [
  // ============= JOURNEYS TAB =============
  // Quick KPIs
  {
    metricId: 'journeys.total',
    tab: 'journeys',
    title: 'Total Journeys',
    source: 'api/journeys/count',
    requestParams: {},
    target: { path: '/tms/journeys', defaultFilters: {} },
    group: 'quickKPI',
    order: 1,
  },
  {
    metricId: 'journeys.active',
    tab: 'journeys',
    title: 'Active',
    source: 'api/journeys/count',
    requestParams: { journey_status: ['PLANNED', 'IN_TRANSIT'] },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: ['PLANNED', 'IN_TRANSIT'] } },
    group: 'quickKPI',
    order: 2,
  },
  {
    metricId: 'journeys.delayed',
    tab: 'journeys',
    title: 'Delayed',
    source: 'api/journeys/count',
    requestParams: { active_analytics: ['delay_in_minutes'] },
    target: { path: '/tms/journeys', defaultFilters: { isDelayed: 'true' } },
    statusType: 'warning',
    group: 'quickKPI',
    order: 3,
  },
  {
    metricId: 'journeys.exceptions',
    tab: 'journeys',
    title: 'Exceptions',
    source: 'api/journeys/count',
    requestParams: { has_exceptions: true },
    target: { path: '/tms/journeys', defaultFilters: { has_exceptions: 'true' } },
    statusType: 'critical',
    group: 'quickKPI',
    order: 4,
  },

  // Lifecycle: Planned
  {
    metricId: 'journeys.planned',
    tab: 'journeys',
    title: 'Planned',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'PLANNED' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'PLANNED' } },
    group: 'lifecycle.planned',
    order: 1,
  },
  {
    metricId: 'journeys.planned.on_time',
    tab: 'journeys',
    title: 'On Schedule',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'PLANNED', scheduled_departure_variance: '<= 0' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'PLANNED', on_schedule: 'true' } },
    statusType: 'positive',
    group: 'lifecycle.planned.status',
    order: 1,
  },
  {
    metricId: 'journeys.planned.late_start',
    tab: 'journeys',
    title: 'Late Start',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'PLANNED', scheduled_departure_variance: '> 0' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'PLANNED', on_schedule: 'false' } },
    statusType: 'warning',
    group: 'lifecycle.planned.status',
    order: 2,
  },
  {
    metricId: 'journeys.planned.pending_vehicle',
    tab: 'journeys',
    title: 'Pending Vehicle Assignment',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'PLANNED', vehicle_assigned: false },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'PLANNED', vehicle_assigned: 'false' } },
    statusType: 'warning',
    group: 'lifecycle.planned.exceptions',
    order: 1,
  },

  // Lifecycle: In Transit
  {
    metricId: 'journeys.in_transit',
    tab: 'journeys',
    title: 'In Transit',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT' } },
    group: 'lifecycle.in_transit',
    order: 1,
  },
  {
    metricId: 'journeys.in_transit.on_time',
    tab: 'journeys',
    title: 'On Time',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT', is_delayed: false },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT', is_delayed: 'false' } },
    statusType: 'positive',
    group: 'lifecycle.in_transit.status',
    order: 1,
  },
  {
    metricId: 'journeys.in_transit.delayed',
    tab: 'journeys',
    title: 'Delayed',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT', is_delayed: true },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT', is_delayed: 'true' } },
    statusType: 'warning',
    group: 'lifecycle.in_transit.status',
    order: 2,
  },
  {
    metricId: 'journeys.in_transit.route_deviation',
    tab: 'journeys',
    title: 'Route Deviation',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT', active_alerts: ['route_deviation'] },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT', active_alerts: 'route_deviation' } },
    statusType: 'critical',
    group: 'lifecycle.in_transit.exceptions',
    order: 1,
  },
  {
    metricId: 'journeys.in_transit.long_stoppage',
    tab: 'journeys',
    title: 'Long Stoppage',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT', active_alerts: ['long_stoppage'] },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT', active_alerts: 'long_stoppage' } },
    statusType: 'warning',
    group: 'lifecycle.in_transit.exceptions',
    order: 2,
  },
  {
    metricId: 'journeys.in_transit.eway_bill',
    tab: 'journeys',
    title: 'E-Way Bill Expiring',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'IN_TRANSIT', active_alerts: ['eway_bill'] },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'IN_TRANSIT', active_alerts: 'eway_bill' } },
    statusType: 'warning',
    group: 'lifecycle.in_transit.exceptions',
    order: 3,
  },

  // Lifecycle: Completed
  {
    metricId: 'journeys.completed',
    tab: 'journeys',
    title: 'Completed',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'COMPLETED' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'COMPLETED' } },
    statusType: 'positive',
    group: 'lifecycle.completed',
    order: 1,
  },
  {
    metricId: 'journeys.completed.on_time',
    tab: 'journeys',
    title: 'Delivered On Time',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'COMPLETED', delivery_variance: '<= 0' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'COMPLETED', on_time_delivery: 'true' } },
    statusType: 'positive',
    group: 'lifecycle.completed.status',
    order: 1,
  },
  {
    metricId: 'journeys.completed.late',
    tab: 'journeys',
    title: 'Late Delivery',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'COMPLETED', delivery_variance: '> 0' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'COMPLETED', on_time_delivery: 'false' } },
    statusType: 'warning',
    group: 'lifecycle.completed.status',
    order: 2,
  },

  // Lifecycle: Closed
  {
    metricId: 'journeys.closed',
    tab: 'journeys',
    title: 'Closed',
    source: 'api/journeys/count',
    requestParams: { journey_status: 'CLOSED' },
    target: { path: '/tms/journeys', defaultFilters: { journey_status: 'CLOSED' } },
    group: 'lifecycle.closed',
    order: 1,
  },

  // ============= ORDERS TAB =============
  {
    metricId: 'orders.total',
    tab: 'orders',
    title: 'Total Orders',
    source: 'api/orders/count',
    requestParams: {},
    target: { path: '/tms/orders', defaultFilters: {} },
    group: 'quickKPI',
    order: 1,
  },
  {
    metricId: 'orders.pending',
    tab: 'orders',
    title: 'Pending',
    source: 'api/orders/count',
    requestParams: { order_status: 'PENDING' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'PENDING' } },
    group: 'quickKPI',
    order: 2,
  },
  {
    metricId: 'orders.confirmed',
    tab: 'orders',
    title: 'Confirmed',
    source: 'api/orders/count',
    requestParams: { order_status: 'CONFIRMED' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'CONFIRMED' } },
    statusType: 'positive',
    group: 'quickKPI',
    order: 3,
  },
  {
    metricId: 'orders.cancelled',
    tab: 'orders',
    title: 'Cancelled',
    source: 'api/orders/count',
    requestParams: { order_status: 'CANCELLED' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'CANCELLED' } },
    statusType: 'critical',
    group: 'quickKPI',
    order: 4,
  },

  // Orders Lifecycle
  {
    metricId: 'orders.lifecycle.new',
    tab: 'orders',
    title: 'New',
    source: 'api/orders/count',
    requestParams: { order_status: 'NEW' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'NEW' } },
    group: 'lifecycle.new',
    order: 1,
  },
  {
    metricId: 'orders.lifecycle.processing',
    tab: 'orders',
    title: 'Processing',
    source: 'api/orders/count',
    requestParams: { order_status: 'PROCESSING' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'PROCESSING' } },
    group: 'lifecycle.processing',
    order: 1,
  },
  {
    metricId: 'orders.lifecycle.dispatched',
    tab: 'orders',
    title: 'Dispatched',
    source: 'api/orders/count',
    requestParams: { order_status: 'DISPATCHED' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'DISPATCHED' } },
    group: 'lifecycle.dispatched',
    order: 1,
  },
  {
    metricId: 'orders.lifecycle.delivered',
    tab: 'orders',
    title: 'Delivered',
    source: 'api/orders/count',
    requestParams: { order_status: 'DELIVERED' },
    target: { path: '/tms/orders', defaultFilters: { order_status: 'DELIVERED' } },
    statusType: 'positive',
    group: 'lifecycle.delivered',
    order: 1,
  },

  // ============= SHIPMENTS TAB =============
  {
    metricId: 'shipments.total',
    tab: 'shipments',
    title: 'Total Shipments',
    source: 'api/shipments/count',
    requestParams: {},
    target: { path: '/tms/shipments', defaultFilters: {} },
    group: 'quickKPI',
    order: 1,
  },
  {
    metricId: 'shipments.in_transit',
    tab: 'shipments',
    title: 'In Transit',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'IN_TRANSIT' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'IN_TRANSIT' } },
    group: 'quickKPI',
    order: 2,
  },
  {
    metricId: 'shipments.delayed',
    tab: 'shipments',
    title: 'Delayed',
    source: 'api/shipments/count',
    requestParams: { is_delayed: true },
    target: { path: '/tms/shipments', defaultFilters: { is_delayed: 'true' } },
    statusType: 'warning',
    group: 'quickKPI',
    order: 3,
  },
  {
    metricId: 'shipments.delivered',
    tab: 'shipments',
    title: 'Delivered',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'DELIVERED' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'DELIVERED' } },
    statusType: 'positive',
    group: 'quickKPI',
    order: 4,
  },

  // Shipments Lifecycle
  {
    metricId: 'shipments.lifecycle.booked',
    tab: 'shipments',
    title: 'Booked',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'BOOKED' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'BOOKED' } },
    group: 'lifecycle.booked',
    order: 1,
  },
  {
    metricId: 'shipments.lifecycle.picked_up',
    tab: 'shipments',
    title: 'Picked Up',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'PICKED_UP' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'PICKED_UP' } },
    group: 'lifecycle.picked_up',
    order: 1,
  },
  {
    metricId: 'shipments.lifecycle.in_transit',
    tab: 'shipments',
    title: 'In Transit',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'IN_TRANSIT' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'IN_TRANSIT' } },
    group: 'lifecycle.in_transit',
    order: 1,
  },
  {
    metricId: 'shipments.lifecycle.delivered',
    tab: 'shipments',
    title: 'Delivered',
    source: 'api/shipments/count',
    requestParams: { shipment_status: 'DELIVERED' },
    target: { path: '/tms/shipments', defaultFilters: { shipment_status: 'DELIVERED' } },
    statusType: 'positive',
    group: 'lifecycle.delivered',
    order: 1,
  },

  // ============= INVOICES TAB =============
  {
    metricId: 'invoices.total',
    tab: 'invoices',
    title: 'Total Invoices',
    source: 'api/invoices/count',
    requestParams: {},
    target: { path: '/tms/invoices', defaultFilters: {} },
    group: 'quickKPI',
    order: 1,
  },
  {
    metricId: 'invoices.pending_approval',
    tab: 'invoices',
    title: 'Pending Approval',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'PENDING_APPROVAL' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'PENDING_APPROVAL' } },
    statusType: 'warning',
    group: 'quickKPI',
    order: 2,
  },
  {
    metricId: 'invoices.disputed',
    tab: 'invoices',
    title: 'Disputed',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'DISPUTED' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'DISPUTED' } },
    statusType: 'critical',
    group: 'quickKPI',
    order: 3,
  },
  {
    metricId: 'invoices.paid',
    tab: 'invoices',
    title: 'Paid',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'PAID' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'PAID' } },
    statusType: 'positive',
    group: 'quickKPI',
    order: 4,
  },

  // Invoices Lifecycle
  {
    metricId: 'invoices.lifecycle.draft',
    tab: 'invoices',
    title: 'Draft',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'DRAFT' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'DRAFT' } },
    group: 'lifecycle.draft',
    order: 1,
  },
  {
    metricId: 'invoices.lifecycle.pending',
    tab: 'invoices',
    title: 'Pending Approval',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'PENDING_APPROVAL' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'PENDING_APPROVAL' } },
    statusType: 'warning',
    group: 'lifecycle.pending',
    order: 1,
  },
  {
    metricId: 'invoices.lifecycle.approved',
    tab: 'invoices',
    title: 'Approved',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'APPROVED' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'APPROVED' } },
    statusType: 'positive',
    group: 'lifecycle.approved',
    order: 1,
  },
  {
    metricId: 'invoices.lifecycle.paid',
    tab: 'invoices',
    title: 'Paid',
    source: 'api/invoices/count',
    requestParams: { invoice_status: 'PAID' },
    target: { path: '/tms/invoices', defaultFilters: { invoice_status: 'PAID' } },
    statusType: 'positive',
    group: 'lifecycle.paid',
    order: 1,
  },
]

export const getMetricsByTab = (tab: TabId): MetricDefinition[] => {
  return metricsRegistry.filter((m) => m.tab === tab)
}

export const getMetricById = (metricId: string): MetricDefinition | undefined => {
  return metricsRegistry.find((m) => m.metricId === metricId)
}
